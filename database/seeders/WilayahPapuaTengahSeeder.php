<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\MasterProvinsi;
use App\Models\MasterKabupaten;
use App\Models\MasterKecamatan;
use App\Models\MasterKelurahan;
use Illuminate\Support\Facades\DB;

class WilayahPapuaTengahSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        $this->command->info('Memulai seeding Wilayah Papua Tengah & Mimika...');

        // Gunakan Transaction untuk memastikan integritas data (All or Nothing)
        DB::beginTransaction();

        try {
            // ==========================================
            // 1. PROVINSI
            // ==========================================
            $provinsi = MasterProvinsi::updateOrCreate(
                ['id' => 94], // Key
                ['nama' => 'Papua Tengah'] // Value
            );
            
            // ==========================================
            // 2. KABUPATEN
            // ==========================================
            MasterKabupaten::updateOrCreate(
                ['id' => 9412],
                [
                    'provinsi_id' => 94,
                    'nama' => 'KABUPATEN MIMIKA'
                ]
            );

            // ==========================================
            // 3. KECAMATAN
            // ==========================================
            $kecamatans = [
                ['id' => '9412010', 'nama' => 'MIMIKA BARAT'],
                ['id' => '9412011', 'nama' => 'MIMIKA BARAT JAUH'],
                ['id' => '9412012', 'nama' => 'MIMIKA BARAT TENGAH'],
                ['id' => '9412013', 'nama' => 'AMAR'],
                ['id' => '9412020', 'nama' => 'MIMIKA TIMUR'],
                ['id' => '9412021', 'nama' => 'MIMIKA TENGAH'],
                ['id' => '9412022', 'nama' => 'MIMIKA TIMUR JAUH'],
                ['id' => '9412030', 'nama' => 'MIMIKA BARU'],
                ['id' => '9412031', 'nama' => 'KUALA KENCANA'],
                ['id' => '9412032', 'nama' => 'TEMBAGAPURA'],
                ['id' => '9412033', 'nama' => 'WANIA'],
                ['id' => '9412034', 'nama' => 'IWAKA'],
                ['id' => '9412035', 'nama' => 'KWAMKI NARAMA'],
                ['id' => '9412040', 'nama' => 'AGIMUGA'],
                ['id' => '9412041', 'nama' => 'JILA'],
                ['id' => '9412042', 'nama' => 'JITA'],
                ['id' => '9412043', 'nama' => 'ALAMA'],
                ['id' => '9412044', 'nama' => 'HOYA'],
            ];

            foreach ($kecamatans as $kec) {
                MasterKecamatan::updateOrCreate(
                    ['id' => $kec['id']],
                    [
                        'kabupaten_id' => 9412,
                        'nama' => $kec['nama']
                    ]
                );
            }

            // ==========================================
            // 4. KELURAHAN / DESA (Beserta Koordinat)
            // ==========================================
            // Format: [ID, Kecamatan_ID, Nama, Lat, Long]
            $kelurahans = [
                // MIMIKA BARAT
                ['9412010020', '9412010', 'KOKONAO', -4.711988, 136.436418],
                ['9412010021', '9412010', 'MIGIWIA', -4.713642, 136.442142],
                ['9412010022', '9412010', 'MIMIKA', null, null],
                ['9412010023', '9412010', 'KIYURA', null, null],
                ['9412010024', '9412010', 'APURI', -4.712654, 136.435031],
                ['9412010025', '9412010', 'ATAPO', -4.715134, 136.448139],
                ['9412010026', '9412010', 'APARUKA', -4.36327, 136.4024],
                
                // MIMIKA BARAT JAUH
                ['9412011001', '9412011', 'POTOWAYBURU', -4.283979, 134.967522],
                ['9412011002', '9412011', 'YAPAKOPA', -4.438571, 135.483889],
                ['9412011003', '9412011', 'AINDUA', -4.460724, 135.197954],
                ['9412011004', '9412011', 'TAPORMAI', -4.392772, 135.369444],
                ['9412011005', '9412011', 'UMAR', null, null],

                // MIMIKA BARAT TENGAH
                ['9412012001', '9412012', 'PRONGGO', null, null],
                ['9412012002', '9412012', 'KIPIA', -4.48731, 135.761218],
                ['9412012003', '9412012', 'MAPAR', null, null],
                ['9412012004', '9412012', 'AKAR', -4.441481, 135.882232],
                ['9412012005', '9412012', 'KAPIRAYA', -4.471719, 136.068711],
                ['9412012006', '9412012', 'UTA', -4.549291, 136.00396],
                ['9412012007', '9412012', 'MUPURUKA', null, null],
                ['9412012008', '9412012', 'WUMUKA', -4.463786, 135.901648],
                ['9412012009', '9412012', 'WAKIA', -4.44258, 136.041684],

                // AMAR
                ['9412013001', '9412013', 'IPIRI', -4.476356, 136.279551],
                ['9412013002', '9412013', 'PARIPI', -4.433302, 136.333943],
                ['9412013003', '9412013', 'YARAYA', -4.460386, 136.385044],
                ['9412013004', '9412013', 'AMAR', -4.623305, 136.146626],
                ['9412013005', '9412013', 'KAWAR', -4.643247, 136.21944],
                ['9412013006', '9412013', 'MANUARE', -4.623305, 136.146626],

                // MIMIKA TIMUR
                ['9412020004', '9412020', 'POMAKO', -4.774241, 136.775387],
                ['9412020009', '9412020', 'TIPUKA', -4.707209, 136.832406],
                ['9412020010', '9412020', 'HIRIPAU', null, null],
                ['9412020012', '9412020', 'KAUGAPU', -4.670981, 136.812535],
                ['9412020013', '9412020', 'WANIA', -4.673208, 136.827697],
                ['9412020015', '9412020', 'MWAPI', -4.664944, 136.824634],

                // MIMIKA TENGAH
                ['9412021001', '9412021', 'KEAKWA', -4.763115, 136.5191],
                ['9412021002', '9412021', 'TIWAKA', null, null],
                ['9412021003', '9412021', 'ATUKA', -4.793841, 136.570842],
                ['9412021004', '9412021', 'AIKAWAPUKA', -4.68132, 136.583767],
                ['9412021005', '9412021', 'KAMORA', null, null],

                // MIMIKA TIMUR JAUH
                ['9412022001', '9412022', 'FANAMO', null, null],
                ['9412022002', '9412022', 'OHOTYA', null, null],
                ['9412022003', '9412022', 'OMAWITA', -4.758433, 137.141833],
                ['9412022004', '9412022', 'AMAMAPARE', -4.849439, 136.892851],
                ['9412022005', '9412022', 'AYUKA', null, null],

                // MIMIKA BARU (Pusat Kota)
                ['9412030004', '9412030', 'KOPERAPOKA', -4.551627, 136.880476],
                ['9412030012', '9412030', 'TIMIKA JAYA', -4.517801, 136.847296],
                ['9412030013', '9412030', 'KWAMKI BARU', -4.546326, 136.8895],
                ['9412030015', '9412030', 'NAYARO', -4.562857, 136.831425],
                ['9412030016', '9412030', 'TIMIKA INDAH', -4.544044, 136.882519],
                ['9412030017', '9412030', 'OTOMONA', -4.55395, 136.883369],
                ['9412030018', '9412030', 'DINGONARAMA', 4.548347, 136.894865],
                ['9412030019', '9412030', 'PASAR SENTRAL', -4.56514, 136.870528],
                ['9412030020', '9412030', 'WANAGON', -4.520004, 136.847401],
                ['9412030021', '9412030', 'SEMPAN', -4.566302, 136.893142],
                ['9412030022', '9412030', 'HANGAITJI', -4.521782, 136.85573],
                ['9412030023', '9412030', 'NINABUA', -4.540915, 136.863431],
                ['9412030024', '9412030', 'KEBUN SIRIH', -4.544017, 136.897614],
                ['9412030025', '9412030', 'PERINTIS', -4.550348, 136.879919],

                // KUALA KENCANA
                ['9412031003', '9412031', 'KARANG SENANG', -4.47901, 136.870203],
                ['9412031004', '9412031', 'KUALA KENCANA', -4.461932, 136.860793],
                ['9412031006', '9412031', 'UTIKINI BARU', -4.46779, 136.819242],
                ['9412031007', '9412031', 'BHINTUKA', -4.456648, 136.802062],
                ['9412031008', '9412031', 'PIOKA KENCANA', -4.445852, 136.818988],
                ['9412031009', '9412031', 'MIMIKA GUNUNG', null, null],
                ['9412031010', '9412031', 'KARYA KENCANA', -4.461787, 136.853754],
                ['9412031011', '9412031', 'JIMBI', null, null],
                ['9412031012', '9412031', 'UTIKINI II', -4.472166, 136.828248],
                ['9412031013', '9412031', 'UTIKINI III', -4.471796, 136.824308],

                // TEMBAGAPURA
                ['9412032001', '9412032', 'TEMBAGAPURA', -4.142602, 137.091319],
                ['9412032002', '9412032', 'WAA', -4.157287, 137.054798],
                ['9412032003', '9412032', 'ARWANDOP', -4.349765, 136.985202],
                ['9412032004', '9412032', 'TSINGA', -4.214535, 137.202034],
                ['9412032006', '9412032', 'JAGAMIN', -4.313182, 137.093877],
                ['9412032007', '9412032', 'OPITAWAK', -4.264234, 137.004417],
                ['9412032008', '9412032', 'DOLININGOKNGIN', -4.387258, 137.266227],
                ['9412032009', '9412032', 'BANIGOGOM', -4.456453, 137.135446],
                ['9412032010', '9412032', 'BANTI II', -4.156732, 137.055698],

                // WANIA
                ['9412033001', '9412033', 'KAMORO JAYA', -4.585456, 136.853074],
                ['9412033002', '9412033', 'MONOKAU JAYA', -4.579838, 136.885076],
                ['9412033003', '9412033', 'WONOSARI JAYA', -4.59647, 136.878999],
                ['9412033004', '9412033', 'MANDIRI JAYA', null, null],
                ['9412033005', '9412033', 'INAUGA', 4.577059, 136.902211],
                ['9412033006', '9412033', 'NAWARIPI', -4.559926, 136.8828],
                ['9412033007', '9412033', 'KADUN JAYA', null, null],

                // IWAKA
                ['9412034001', '9412034', 'LIMAU ASRI', -4.530561, 136.774862],
                ['9412034002', '9412034', 'LIMAU ASRI BARAT', -4.530176, 136.759608],
                ['9412034003', '9412034', 'WANGIRJA', -4.503197, 136.787745],
                ['9412034004', '9412034', 'IWAKA', -4.409647, 136.862064],
                ['9412034005', '9412034', 'NAENA MUKTIPURA', -4.571047, 136.736734],
                ['9412034006', '9412034', 'MULIA KENCANA', -4.488817, 136.782014],
                ['9412034007', '9412034', 'PIGAPU', -4.868531, 136.815009],

                // KWAMKI NARAMA
                ['9412035001', '9412035', 'HARAPAN', null, null],
                ['9412035002', '9412035', 'MEKURIMA', -4.520499, 136.900122],
                ['9412035003', '9412035', 'LANDUM MEKAR', null, null],
                ['9412035004', '9412035', 'OLAROA', -4.49128, 136.880391],
                ['9412035005', '9412035', 'BINTANG LIMA', -4.479132, 136.8832],
                ['9412035006', '9412035', 'DAMAI', -4.485882, 136.890497],
                ['9412035007', '9412035', 'WALANI', -4.455868, 137.135327],
                ['9412035008', '9412035', 'AMOLE', -4.501652, 136.881447],
                ['9412035009', '9412035', 'LAMOPI', null, null],
                ['9412035010', '9412035', 'TUNAS MATOA', -4.479084, 136.872694],

                // AGIMUGA
                ['9412040005', '9412040', 'FAKA FUKU', null, null],
                ['9412040007', '9412040', 'KILIARMA', null, null],
                ['9412040008', '9412040', 'AMUNGUN', -4.675174, 137.605886],
                ['9412040009', '9412040', 'ARAMSOLKI', null, null],
                ['9412040010', '9412040', 'HINAT UNTUNG', null, null],
                ['9412040011', '9412040', 'MASAIMAMO', null, null],
                ['9412040012', '9412040', 'EMKOMA HALAMA', null, null],
                ['9412040013', '9412040', 'EMOGORA', null, null],

                // JILA
                ['9412041001', '9412041', 'JILA', -4.247217, 137.599546],
                ['9412041005', '9412041', 'DILOA', -4.298306, 137.636918],
                ['9412041006', '9412041', 'NOEMUN', -4.24658, 137.429396],
                ['9412041009', '9412041', 'PASIR PUTIH', null, null],
                ['9412041010', '9412041', 'PILIKOGOM', -4.243821, 137.611951],
                ['9412041011', '9412041', 'BUNARAUGIN', null, null],
                ['9412041012', '9412041', 'UMPLIGA', null, null],
                ['9412041013', '9412041', 'DIOLA II', -4.245558, 137.59892],
                ['9412041014', '9412041', 'AMUAOGOM', null, null],
                ['9412041015', '9412041', 'JENGKOAN', null, null],

                // JITA
                ['9412042001', '9412042', 'SUMAPRO', -5.057512, 137.578297],
                ['9412042002', '9412042', 'WAPU', -4.925878, 137.770009],
                ['9412042003', '9412042', 'WENIN', null, null],
                ['9412042004', '9412042', 'NOEMA', -4.885651, 137.552385],
                ['9412042005', '9412042', 'SEMPAN TIMUR', -4.872395, 137.700272],
                ['9412042006', '9412042', 'WACAKAM', null, null],
                ['9412042007', '9412042', 'WAITUKU', -4.925433, 137.527606],
                ['9412042008', '9412042', 'YAITAK', null, null],
                ['9412042010', '9412042', 'KANMAPIRI', null, null],

                // ALAMA
                ['9412043001', '9412043', 'ENGGIN', -4.376939, 137.618054],
                ['9412043002', '9412043', 'SENAWAK', null, null],
                ['9412043003', '9412043', 'GESELAMA', -4.346021, 137.515071],
                ['9412043004', '9412043', 'BEMOKI', null, null],
                ['9412043005', '9412043', 'TAGALARMA', null, null],
                ['9412043006', '9412043', 'UNOMOGOM', null, null],
                ['9412043007', '9412043', 'WUAREM', null, null],
                ['9412043008', '9412043', 'PURUA', null, null],
                ['9412043009', '9412043', 'KELMIT', null, null],
                ['9412043010', '9412043', 'YENGGELO', null, null],
                ['9412043011', '9412043', 'ALAMA', -4.53599, 136.823271],
                ['9412043012', '9412043', 'WANDUD', null, null],

                // HOYA
                ['9412044001', '9412044', 'HOYA', -4.361415, 137.444256],
                ['9412044002', '9412044', 'JINONI', -4.193879, 137.588878],
                ['9412044003', '9412044', 'MAMONTOGA', -4.181965, 137.412962],
                ['9412044004', '9412044', 'KULAMOGAN', null, null],
                ['9412044005', '9412044', 'JAWA', null, null],
                ['9412044006', '9412044', 'PUTI', -4.181965, 137.412962],
            ];

            foreach ($kelurahans as $kel) {
                MasterKelurahan::updateOrCreate(
                    ['id' => $kel[0]], // Check by ID
                    [
                        'kecamatan_id' => $kel[1],
                        'nama' => $kel[2],
                        'latitude' => $kel[3],
                        'longitude' => $kel[4],
                    ]
                );
            }

            DB::commit();
            $this->command->info('Seeder Wilayah Papua Tengah selesai.');
        } catch (\Exception $e) {
            DB::rollBack();
            $this->command->error('Terjadi kesalahan: ' . $e->getMessage());
        }
    }
}